<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Configuration" href="config.html" /><link rel="prev" title="Basics" href="index.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2025.07.19 -->
        <title>Featurizers - PolyglotMol 0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">PolyglotMol 0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <span class="sidebar-brand-text">PolyglotMol 0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quick Start</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../index.html">User Guide</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of User Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../quick_start.html">Complete Workflow Example</a></li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="index.html">Basics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Basics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 current has-children current-page"><a class="current reference internal" href="#">Featurizers</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Featurizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="config.html">Configuration</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Configuration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="shapes.html">Common Featurizer Shapes</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/index.html">Representations</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/sequential/index.html">Sequential Representations</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Sequential Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/sequential/mlm.html">Molecular Language Models</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Molecular Language Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/sequential/tokenizer.html">Tokenizers</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Tokenizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/descriptors/index.html">Molecular Descriptors</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Molecular Descriptors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/descriptors/descriptors_basic.html">Molecular Descriptors</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Molecular Descriptors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/fingerprints/index.html">Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/fingerprints/rdkit.html">RDKit Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of RDKit Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/fingerprints/cdk.html">CDK Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of CDK Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/fingerprints/deepchem.html">DeepChem Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of DeepChem Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/fingerprints/datamol.html">Datamol Fingerprint</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of Datamol Fingerprint</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/graph/index.html">Graph Representations</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of Graph Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/graph/deepchem.html">Graph Representations</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of Graph Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/image/index.html">Image Representations</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of Image Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../representations/image/2d.html">2D Molecular Images</a></li>
<li class="toctree-l4"><a class="reference internal" href="../representations/image/3d.html">3D Molecular Representations</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/spatial/index.html">Spatial Representations</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of Spatial Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/spatial/matrix.html">Matrix Featurizers</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of Matrix Featurizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/spatial/unimol.html">Uni-Mol Representations</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of Uni-Mol Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/temporal/index.html">Temporal Representations</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of Temporal Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/protein/index.html">Protein Representations</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of Protein Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/protein/sequence/index.html">Sequence Representations</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of Sequence Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../representations/protein/sequence/plm.html">Protein Language Models</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of Protein Language Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../representations/protein/sequence/tokenizer.html">Protein Sequence Tokenization</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/protein/structure/index.html">Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../representations/protein/structure/evoformer.html">Protein Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of Protein Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l5 has-children"><a class="reference internal" href="../representations/protein/structure/masif.html">Protein Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of Protein Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../representations/protein-ligand/index.html">Protein-ligand</a></li>
<li class="toctree-l3"><a class="reference internal" href="../representations/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../data/index.html">Data Management</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of Data Management</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../data/molecule.html">Molecule</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Molecule</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../data/dataset.html">Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Dataset</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../models/index.html">Machine Learning Models</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle navigation of Machine Learning Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../models/definitions.html">Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../models/grid_search.html">Grid Search</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle navigation of Grid Search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../models/evaluation.html">Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../models/screening_usage_doc.html">Multi-Stage Model Screening</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../representations/index.html">Representations</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle navigation of Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/sequential/index.html">Sequential Representations</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle navigation of Sequential Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/sequential/mlm.html">Molecular Language Models</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle navigation of Molecular Language Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/sequential/tokenizer.html">Tokenizers</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle navigation of Tokenizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/descriptors/index.html">Molecular Descriptors</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle navigation of Molecular Descriptors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/descriptors/descriptors_basic.html">Molecular Descriptors</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle navigation of Molecular Descriptors</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/fingerprints/index.html">Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle navigation of Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/fingerprints/rdkit.html">RDKit Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle navigation of RDKit Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/fingerprints/cdk.html">CDK Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle navigation of CDK Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/fingerprints/deepchem.html">DeepChem Fingerprints</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle navigation of DeepChem Fingerprints</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/fingerprints/datamol.html">Datamol Fingerprint</a><input class="toctree-checkbox" id="toctree-checkbox-44" name="toctree-checkbox-44" role="switch" type="checkbox"/><label for="toctree-checkbox-44"><div class="visually-hidden">Toggle navigation of Datamol Fingerprint</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/graph/index.html">Graph Representations</a><input class="toctree-checkbox" id="toctree-checkbox-45" name="toctree-checkbox-45" role="switch" type="checkbox"/><label for="toctree-checkbox-45"><div class="visually-hidden">Toggle navigation of Graph Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/graph/deepchem.html">Graph Representations</a><input class="toctree-checkbox" id="toctree-checkbox-46" name="toctree-checkbox-46" role="switch" type="checkbox"/><label for="toctree-checkbox-46"><div class="visually-hidden">Toggle navigation of Graph Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/image/index.html">Image Representations</a><input class="toctree-checkbox" id="toctree-checkbox-47" name="toctree-checkbox-47" role="switch" type="checkbox"/><label for="toctree-checkbox-47"><div class="visually-hidden">Toggle navigation of Image Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../representations/image/2d.html">2D Molecular Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="../representations/image/3d.html">3D Molecular Representations</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/spatial/index.html">Spatial Representations</a><input class="toctree-checkbox" id="toctree-checkbox-48" name="toctree-checkbox-48" role="switch" type="checkbox"/><label for="toctree-checkbox-48"><div class="visually-hidden">Toggle navigation of Spatial Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/spatial/matrix.html">Matrix Featurizers</a><input class="toctree-checkbox" id="toctree-checkbox-49" name="toctree-checkbox-49" role="switch" type="checkbox"/><label for="toctree-checkbox-49"><div class="visually-hidden">Toggle navigation of Matrix Featurizers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/spatial/unimol.html">Uni-Mol Representations</a><input class="toctree-checkbox" id="toctree-checkbox-50" name="toctree-checkbox-50" role="switch" type="checkbox"/><label for="toctree-checkbox-50"><div class="visually-hidden">Toggle navigation of Uni-Mol Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/temporal/index.html">Temporal Representations</a><input class="toctree-checkbox" id="toctree-checkbox-51" name="toctree-checkbox-51" role="switch" type="checkbox"/><label for="toctree-checkbox-51"><div class="visually-hidden">Toggle navigation of Temporal Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../representations/protein/index.html">Protein Representations</a><input class="toctree-checkbox" id="toctree-checkbox-52" name="toctree-checkbox-52" role="switch" type="checkbox"/><label for="toctree-checkbox-52"><div class="visually-hidden">Toggle navigation of Protein Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/protein/sequence/index.html">Sequence Representations</a><input class="toctree-checkbox" id="toctree-checkbox-53" name="toctree-checkbox-53" role="switch" type="checkbox"/><label for="toctree-checkbox-53"><div class="visually-hidden">Toggle navigation of Sequence Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/protein/sequence/plm.html">Protein Language Models</a><input class="toctree-checkbox" id="toctree-checkbox-54" name="toctree-checkbox-54" role="switch" type="checkbox"/><label for="toctree-checkbox-54"><div class="visually-hidden">Toggle navigation of Protein Language Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../representations/protein/sequence/tokenizer.html">Protein Sequence Tokenization</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../representations/protein/structure/index.html">Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-55" name="toctree-checkbox-55" role="switch" type="checkbox"/><label for="toctree-checkbox-55"><div class="visually-hidden">Toggle navigation of Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/protein/structure/evoformer.html">Protein Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-56" name="toctree-checkbox-56" role="switch" type="checkbox"/><label for="toctree-checkbox-56"><div class="visually-hidden">Toggle navigation of Protein Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../representations/protein/structure/masif.html">Protein Structure Representations</a><input class="toctree-checkbox" id="toctree-checkbox-57" name="toctree-checkbox-57" role="switch" type="checkbox"/><label for="toctree-checkbox-57"><div class="visually-hidden">Toggle navigation of Protein Structure Representations</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../representations/protein-ligand/index.html">Protein-ligand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../representations/utils.html">Utils</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/index.html">Data Management</a><input class="toctree-checkbox" id="toctree-checkbox-58" name="toctree-checkbox-58" role="switch" type="checkbox"/><label for="toctree-checkbox-58"><div class="visually-hidden">Toggle navigation of Data Management</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../data/molecule.html">Molecule</a><input class="toctree-checkbox" id="toctree-checkbox-59" name="toctree-checkbox-59" role="switch" type="checkbox"/><label for="toctree-checkbox-59"><div class="visually-hidden">Toggle navigation of Molecule</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../data/dataset.html">Dataset</a><input class="toctree-checkbox" id="toctree-checkbox-60" name="toctree-checkbox-60" role="switch" type="checkbox"/><label for="toctree-checkbox-60"><div class="visually-hidden">Toggle navigation of Dataset</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../models/index.html">Machine Learning Models</a><input class="toctree-checkbox" id="toctree-checkbox-61" name="toctree-checkbox-61" role="switch" type="checkbox"/><label for="toctree-checkbox-61"><div class="visually-hidden">Toggle navigation of Machine Learning Models</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/definitions.html">Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/preprocessing.html">Preprocessing</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../models/grid_search.html">Grid Search</a><input class="toctree-checkbox" id="toctree-checkbox-62" name="toctree-checkbox-62" role="switch" type="checkbox"/><label for="toctree-checkbox-62"><div class="visually-hidden">Toggle navigation of Grid Search</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../models/evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/screening_usage_doc.html">Multi-Stage Model Screening</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../api/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-63" name="toctree-checkbox-63" role="switch" type="checkbox"/><label for="toctree-checkbox-63"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/representations/index.html">Representations Module</a><input class="toctree-checkbox" id="toctree-checkbox-64" name="toctree-checkbox-64" role="switch" type="checkbox"/><label for="toctree-checkbox-64"><div class="visually-hidden">Toggle navigation of Representations Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/sequential/index.html">Sequential Representations API (<cite>…sequential</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-65" name="toctree-checkbox-65" role="switch" type="checkbox"/><label for="toctree-checkbox-65"><div class="visually-hidden">Toggle navigation of Sequential Representations API (…sequential)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/sequential/language_model.html">Language Model API (<cite>…language_model</cite>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/sequential/tokenizer.html">Tokenizer API (<cite>…tokenizer</cite>)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/descriptors/index.html">Descriptors API (<cite>…descriptors</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-66" name="toctree-checkbox-66" role="switch" type="checkbox"/><label for="toctree-checkbox-66"><div class="visually-hidden">Toggle navigation of Descriptors API (…descriptors)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/descriptors/descriptors_basic.html">Molecular Descriptors API (<cite>…sequential</cite>)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/fingerprints/index.html">Fingerprints API (<cite>polyglotmol.representations.fingerprints</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-67" name="toctree-checkbox-67" role="switch" type="checkbox"/><label for="toctree-checkbox-67"><div class="visually-hidden">Toggle navigation of Fingerprints API (polyglotmol.representations.fingerprints)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/fingerprints/rdkit.html">RDKit Fingerprints (<cite>rdkit</cite>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/fingerprints/cdk.html">CDK Fingerprints API (<cite>…cdk</cite>)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/fingerprints/deepchem.html">API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/fingerprints/datamol.html">datamol Fingerprints API (<cite>…datamol</cite>)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/graph/index.html">Graph Representations API (<cite>…graph</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-68" name="toctree-checkbox-68" role="switch" type="checkbox"/><label for="toctree-checkbox-68"><div class="visually-hidden">Toggle navigation of Graph Representations API (…graph)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/graph/deepchem.html">DeepChem Graph Representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/graph/graph.html">Graph Representations API (<cite>…graph</cite>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/representations/image/index.html">Image Representations API (<cite>…image</cite>)</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/spatial/index.html">Spatial Representations API (<code class="xref py py-obj docutils literal notranslate"><span class="pre">spatial</span></code>)</a><input class="toctree-checkbox" id="toctree-checkbox-69" name="toctree-checkbox-69" role="switch" type="checkbox"/><label for="toctree-checkbox-69"><div class="visually-hidden">Toggle navigation of Spatial Representations API (spatial)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/matrix.html"><code class="docutils literal notranslate"><span class="pre">CoulombMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/matrix.html#polyglotmol.representations.spatial.matrix.CoulombMatrixEig"><code class="docutils literal notranslate"><span class="pre">CoulombMatrixEig</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/matrix.html#polyglotmol.representations.spatial.matrix.AdjacencyMatrix"><code class="docutils literal notranslate"><span class="pre">AdjacencyMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/matrix.html#polyglotmol.representations.spatial.matrix.EdgeMatrix"><code class="docutils literal notranslate"><span class="pre">EdgeMatrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/matrix.html#matrix-based-spatial-representations">Matrix-Based Spatial Representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/unimol.html"><code class="docutils literal notranslate"><span class="pre">UniMolCLSFeaturizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/unimol.html#polyglotmol.representations.spatial.unimol.UniMolAtomicCoordsFeaturizer"><code class="docutils literal notranslate"><span class="pre">UniMolAtomicCoordsFeaturizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/unimol.html#polyglotmol.representations.spatial.unimol.UniMolAtomicReprsFeaturizer"><code class="docutils literal notranslate"><span class="pre">UniMolAtomicReprsFeaturizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../api/representations/spatial/unimol.html#uni-mol-representations">Uni-Mol Representations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/representations/temporal/index.html">Sequential Representations API (<cite>…sequential</cite>)</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../api/representations/protein/index.html">Protein Representations API (<cite>…protein</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-70" name="toctree-checkbox-70" role="switch" type="checkbox"/><label for="toctree-checkbox-70"><div class="visually-hidden">Toggle navigation of Protein Representations API (…protein)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4 has-children"><a class="reference internal" href="../../api/representations/protein/sequence/index.html">Protein Sequence API (<cite>…sequence</cite>)</a><input class="toctree-checkbox" id="toctree-checkbox-71" name="toctree-checkbox-71" role="switch" type="checkbox"/><label for="toctree-checkbox-71"><div class="visually-hidden">Toggle navigation of Protein Sequence API (…sequence)</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html"><code class="docutils literal notranslate"><span class="pre">BasePLMFeaturizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.SequencePreprocessor"><code class="docutils literal notranslate"><span class="pre">SequencePreprocessor</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.ESM2Featurizer"><code class="docutils literal notranslate"><span class="pre">ESM2Featurizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.ESMCFeaturizer"><code class="docutils literal notranslate"><span class="pre">ESMCFeaturizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.ProtT5Featurizer"><code class="docutils literal notranslate"><span class="pre">ProtT5Featurizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.AnkhFeaturizer"><code class="docutils literal notranslate"><span class="pre">AnkhFeaturizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.CARPFeaturizer"><code class="docutils literal notranslate"><span class="pre">CARPFeaturizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#polyglotmol.representations.protein.sequence.plm.PepBERTFeaturizer"><code class="docutils literal notranslate"><span class="pre">PepBERTFeaturizer</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/plm.html#protein-language-model-plm-featurizers">Protein Language Model (PLM) Featurizers</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../api/representations/protein/sequence/tokenizer.html">Protein Sequence API (<cite>…sequence</cite>)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api/representations/protein-ligand/index.html">Protein Representations API (<cite>…protein</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/representations/utils.html">Representation Utilities API (<cite>…utils</cite>)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/data/index.html">Data Module</a><input class="toctree-checkbox" id="toctree-checkbox-72" name="toctree-checkbox-72" role="switch" type="checkbox"/><label for="toctree-checkbox-72"><div class="visually-hidden">Toggle navigation of Data Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/data/io.html">Dataset overview Utilities API (<cite>polyglotmol.data.overview</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/data/molecule.html">Dataset overview Utilities API (<cite>polyglotmol.data.overview</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/data/dataset.html">Dataset overview Utilities API (<cite>polyglotmol.data.overview</cite>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/data/overview.html">Dataset overview Utilities API (<cite>polyglotmol.data.overview</cite>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api/data/index.html#module-polyglotmol.data.io">Module Hierarchy</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/models/index.html">Models Module</a><input class="toctree-checkbox" id="toctree-checkbox-73" name="toctree-checkbox-73" role="switch" type="checkbox"/><label for="toctree-checkbox-73"><div class="visually-hidden">Toggle navigation of Models Module</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../api/drawings/index.html">Drawings API</a><input class="toctree-checkbox" id="toctree-checkbox-74" name="toctree-checkbox-74" role="switch" type="checkbox"/><label for="toctree-checkbox-74"><div class="visually-hidden">Toggle navigation of Drawings API</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api/drawings/graph_plots.html">Drawings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/drawings/model_plots.html">Drawings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api/drawings/molecule_plots.html">Drawings</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../development/index.html">Development Guide</a><input class="toctree-checkbox" id="toctree-checkbox-75" name="toctree-checkbox-75" role="switch" type="checkbox"/><label for="toctree-checkbox-75"><div class="visually-hidden">Toggle navigation of Development Guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../development/contributing.html">Contributing to PolyglotMol</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/setup_dev_env.html">Setting Up Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/testing.html">Running Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/featurizer.html">Summary of Fingerprint Registration Mechanisms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../development/add_featurizer.html">Adding a New Featurizer to PolyglotMol</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../../_sources/usage/basic/featurizers.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="featurizers">
<h1>Featurizers<a class="headerlink" href="#featurizers" title="Link to this heading">¶</a></h1>
<p>PolyglotMol offers a comprehensive suite of tools for generating diverse molecular and protein representations. These representations, often called “features” or “embeddings,” are crucial for training machine learning models in cheminformatics and bioinformatics. PolyglotMol provides a unified interface for molecular featurization, supporting both small molecules and proteins. All featurizers aim to follow a consistent API pattern, making it easy to switch between different representations.</p>
<p>Featurizers transform molecular structures (e.g., from SMILES strings, SDF/PDB files) or protein sequences into numerical representations suitable for machine learning. The library organizes featurizers by type and provides tools to discover, instantiate, and use them effectively.</p>
<section id="core-workflow">
<h2>Core Workflow<a class="headerlink" href="#core-workflow" title="Link to this heading">¶</a></h2>
<p>Generating representations with PolyglotMol typically involves the following steps:</p>
<ol class="arabic simple">
<li><p><strong>Discover Available Featurizers</strong>: Identify the representations PolyglotMol offers for your specific data type (small molecules or proteins).</p></li>
<li><p><strong>Get a Specific Featurizer</strong>: Instantiate the desired featurizer, usually by its unique registered name, and optionally customize its parameters.</p></li>
<li><p><strong>Prepare Input Data</strong>: Ensure your input data (like SMILES strings, RDKit Mol objects, or protein sequences) is in a format the featurizer can process. PolyglotMol featurizers often handle common input types directly.</p></li>
<li><p><strong>Generate Representations</strong>: Apply the featurizer to your molecule(s) or sequence(s) to obtain the numerical features.</p></li>
</ol>
<p>Let’s explore each of these steps in more detail.</p>
</section>
<hr class="docutils" />
<section id="discovering-available-featurizers">
<h2>1. Discovering Available Featurizers<a class="headerlink" href="#discovering-available-featurizers" title="Link to this heading">¶</a></h2>
<p>PolyglotMol maintains separate registries for featurizers designed for small molecules and those for proteins.</p>
<section id="listing-featurizer-names">
<h3>Listing Featurizer Names<a class="headerlink" href="#listing-featurizer-names" title="Link to this heading">¶</a></h3>
<p>You can easily get a list of registered names:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># List all available small molecule featurizer names</span>
<span class="n">sm_featurizer_names</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">list_available_featurizers</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total small molecule featurizers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">sm_featurizer_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">sm_featurizer_names</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Examples: </span><span class="si">{</span><span class="n">sm_featurizer_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Total small molecule featurizers: 72</span>
<span class="c1"># Examples: [&#39;UniMol-CLS-unimolv1-WithHs&#39;, &#39;UniMol-CLS-unimolv2-1.1b-NoHs&#39;, &#39;UniMol-CLS-unimolv2-1.1b-WithHs&#39;]</span>

<span class="c1"># List all available protein featurizer names</span>
<span class="n">protein_featurizer_names</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">list_available_protein_featurizers</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total protein featurizers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">protein_featurizer_names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">protein_featurizer_names</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Examples: </span><span class="si">{</span><span class="n">protein_featurizer_names</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Total protein featurizers: 12</span>
<span class="c1"># Examples: [&#39;ankh&#39;, &#39;carp&#39;, &#39;esm2&#39;]</span>
</pre></div>
</div>
</section>
<section id="categorized-and-pretty-printed-view">
<h3>Categorized and Pretty-Printed View<a class="headerlink" href="#categorized-and-pretty-printed-view" title="Link to this heading">¶</a></h3>
<p>For a more structured and user-friendly overview, especially in an interactive console, you can print a categorized tree of available featurizers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Pretty print small molecule featurizers in a categorized tree</span>
<span class="n">pm</span><span class="o">.</span><span class="n">print_available_featurizers</span><span class="p">(</span><span class="n">categorized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">registry_type</span><span class="o">=</span><span class="s1">&#39;small_molecule&#39;</span><span class="p">)</span>

<span class="c1"># Pretty print protein featurizers</span>
<span class="n">pm</span><span class="o">.</span><span class="n">print_available_featurizers</span><span class="p">(</span><span class="n">categorized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">registry_type</span><span class="o">=</span><span class="s1">&#39;protein&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An example output for small molecule featurizers might look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Available Small Molecule Featurizers
====================================
Total: 72 featurizers in 10 categories

├── fingerprints (45 items)
│   ├── rdkit (20 items)
│   │   ├── morgan (8 items)
│   │   │   ├── morgan_fp_r2_2048
│   │   │   ├── morgan_fp_r3_2048
│   │   │   └── ...
│   │   └── maccs (1 item)
│   │       └── maccs_keys
│   ├── deepchem (10 items)
│   │   ├── circular_fp
│   │   └── ...
│   └── cdk (15 items)
├── descriptors (25 items)
│   ├── rdkit (20 items)
│   └── mordred (5 items)
└── spatial (20 items)
    ├── matrix (10 items)
    │   ├── coulomb_matrix
    │   └── ...
    └── unimol (10 items)
</pre></div>
</div>
</section>
<section id="getting-detailed-information-with-shape">
<h3>Getting Detailed Information with Shape<a class="headerlink" href="#getting-detailed-information-with-shape" title="Link to this heading">¶</a></h3>
<p>To learn more about a specific featurizer, including its underlying class, default parameters, output shape, and description:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Get info for a small molecule featurizer</span>
<span class="n">info_morgan</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">info_morgan</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Info for &#39;morgan_fp_r2_1024&#39;:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  class: </span><span class="si">{</span><span class="n">info_morgan</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  shape: </span><span class="si">{</span><span class="n">info_morgan</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># Shape at top level!</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  shape_type: </span><span class="si">{</span><span class="n">info_morgan</span><span class="p">[</span><span class="s1">&#39;shape_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  default_kwargs: </span><span class="si">{</span><span class="n">info_morgan</span><span class="p">[</span><span class="s1">&#39;default_kwargs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  description: </span><span class="si">{</span><span class="n">info_morgan</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Info for &#39;morgan_fp_r2_1024&#39;:</span>
<span class="c1">#   class: &lt;class &#39;polyglotmol.representations.fingerprints.rdkit.MorganBitFP&#39;&gt;</span>
<span class="c1">#   shape: (1024,)</span>
<span class="c1">#   shape_type: fixed</span>
<span class="c1">#   default_kwargs: {&#39;radius&#39;: 2, &#39;nBits&#39;: 1024}</span>
<span class="c1">#   description: Morgan fingerprint (radius 2, 1024 bits) (via RDKit)</span>

<span class="c1"># Get info for a protein featurizer</span>
<span class="n">info_esm</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_protein_featurizer_info</span><span class="p">(</span><span class="s1">&#39;esm2_t6_8M_UR50D&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">info_esm</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Info for &#39;esm2_t6_8M_UR50D&#39;:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  class: </span><span class="si">{</span><span class="n">info_esm</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  shape: </span><span class="si">{</span><span class="n">info_esm</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># CLS token shape</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  per_residue_shape: </span><span class="si">{</span><span class="n">info_esm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;per_residue_shape&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  default_kwargs: </span><span class="si">{</span><span class="n">info_esm</span><span class="p">[</span><span class="s1">&#39;default_kwargs&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Info for &#39;esm2_t6_8M_UR50D&#39;:</span>
<span class="c1">#   class: &lt;class &#39;polyglotmol.representations.protein.sequence.plm.ESM2Featurizer&#39;&gt;</span>
<span class="c1">#   shape: (320,)</span>
<span class="c1">#   per_residue_shape: (None, 320)</span>
<span class="c1">#   default_kwargs: {&#39;plm_key&#39;: &#39;esm2_t6_8M_UR50D&#39;, ...}</span>

<span class="c1"># Quick shape check for any featurizer</span>
<span class="k">def</span><span class="w"> </span><span class="nf">get_shape</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_protein_featurizer_info</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">info</span> <span class="k">else</span> <span class="kc">None</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Morgan FP shape: </span><span class="si">{</span><span class="n">get_shape</span><span class="p">(</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (1024,)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Count FP shape: </span><span class="si">{</span><span class="n">get_shape</span><span class="p">(</span><span class="s1">&#39;ecfp4_count&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># &#39;dynamic&#39;</span>
</pre></div>
</div>
</section>
<section id="checking-shapes-of-all-cdk-fingerprints">
<h3>Checking Shapes of All CDK Fingerprints<a class="headerlink" href="#checking-shapes-of-all-cdk-fingerprints" title="Link to this heading">¶</a></h3>
<p>Here’s how to examine the shapes of all CDK fingerprints:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Get all CDK fingerprints</span>
<span class="n">cdk_fingerprints</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">select_featurizers_by_category</span><span class="p">(</span><span class="s2">&quot;fingerprints/cdk&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">cdk_fingerprints</span><span class="p">)</span><span class="si">}</span><span class="s2"> CDK fingerprints</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check shapes of all CDK fingerprints</span>
<span class="n">cdk_shapes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">fp_name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cdk_fingerprints</span><span class="p">):</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="n">fp_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span>
        <span class="n">shape_type</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;shape_type&#39;</span><span class="p">]</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">][:</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;...&quot;</span>
        
        <span class="c1"># Group by shape</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cdk_shapes</span><span class="p">:</span>
            <span class="n">cdk_shapes</span><span class="p">[</span><span class="n">shape</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cdk_shapes</span><span class="p">[</span><span class="n">shape</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">fp_name</span><span class="p">,</span> <span class="n">desc</span><span class="p">))</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">fp_name</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Shape: </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">shape_type</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Desc: </span><span class="si">{</span><span class="n">desc</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Summary by shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">CDK Fingerprints grouped by shape:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">shape</span><span class="p">,</span> <span class="n">fps</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cdk_shapes</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Shape </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span><span class="si">}</span><span class="s2"> fingerprints&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">desc</span> <span class="ow">in</span> <span class="n">fps</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>  <span class="c1"># Show first 3</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">3</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>

<span class="c1"># Example Output:</span>
<span class="c1"># Found 15 CDK fingerprints</span>
<span class="c1">#</span>
<span class="c1"># cdk_atompairs2d:</span>
<span class="c1">#   Shape: (780,) (fixed)</span>
<span class="c1">#   Desc: CDK Atom Pairs 2D fingerprint (780 bits)...</span>
<span class="c1">#</span>
<span class="c1"># cdk_circular:</span>
<span class="c1">#   Shape: (1024,) (fixed)</span>
<span class="c1">#   Desc: CDK Circular/ECFP-like fingerprint (1024 bits)...</span>
<span class="c1">#</span>
<span class="c1"># CDK Fingerprints grouped by shape:</span>
<span class="c1"># Shape (780,): 1 fingerprints</span>
<span class="c1">#   - cdk_atompairs2d</span>
<span class="c1"># Shape (1024,): 8 fingerprints</span>
<span class="c1">#   - cdk_circular</span>
<span class="c1">#   - cdk_extended</span>
<span class="c1">#   - cdk_graphonly</span>
<span class="c1">#   ... and 5 more</span>
</pre></div>
</div>
</section>
<section id="finding-featurizers-by-shape">
<h3>Finding Featurizers by Shape<a class="headerlink" href="#finding-featurizers-by-shape" title="Link to this heading">¶</a></h3>
<p>You can also search for featurizers based on their output shape:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Find all 2048-bit fingerprints</span>
<span class="k">def</span><span class="w"> </span><span class="nf">find_by_shape</span><span class="p">(</span><span class="n">target_shape</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all featurizers with a specific shape.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">select_featurizers_by_category</span><span class="p">(</span><span class="n">category</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">candidates</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">list_available_featurizers</span><span class="p">()</span>
    
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">candidates</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">info</span> <span class="ow">and</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">target_shape</span><span class="p">:</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># Find all 2048-dimensional fingerprints</span>
<span class="n">fp_2048</span> <span class="o">=</span> <span class="n">find_by_shape</span><span class="p">((</span><span class="mi">2048</span><span class="p">,),</span> <span class="n">category</span><span class="o">=</span><span class="s2">&quot;fingerprints&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fp_2048</span><span class="p">)</span><span class="si">}</span><span class="s2"> fingerprints with shape (2048,):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">fp</span> <span class="ow">in</span> <span class="n">fp_2048</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">fp</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fp_2048</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  ... and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">fp_2048</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">5</span><span class="si">}</span><span class="s2"> more&quot;</span><span class="p">)</span>

<span class="c1"># Find all dynamic-shape featurizers</span>
<span class="n">dynamic_feats</span> <span class="o">=</span> <span class="n">find_by_shape</span><span class="p">(</span><span class="s2">&quot;dynamic&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">dynamic_feats</span><span class="p">)</span><span class="si">}</span><span class="s2"> featurizers with dynamic shapes:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">dynamic_feats</span><span class="p">[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="n">feat</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - </span><span class="si">{</span><span class="n">feat</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;metadata&#39;</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">][:</span><span class="mi">40</span><span class="p">]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="shape-compatibility-check">
<h3>Shape Compatibility Check<a class="headerlink" href="#shape-compatibility-check" title="Link to this heading">¶</a></h3>
<p>When building ensemble models, it’s important to check shape compatibility:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Check if multiple featurizers have compatible shapes</span>
<span class="n">featurizers_to_check</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;morgan_fp_r2_2048&#39;</span><span class="p">,</span>
    <span class="s1">&#39;rdkit_fp_2048&#39;</span><span class="p">,</span>
    <span class="s1">&#39;datamol_ecfp4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;maccs_keys&#39;</span>  <span class="c1"># Different shape!</span>
<span class="p">]</span>

<span class="n">shapes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">featurizers_to_check</span><span class="p">:</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer_info</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">info</span><span class="p">:</span>
        <span class="n">shapes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape compatibility check:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Check if all shapes are the same</span>
<span class="n">unique_shapes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">shapes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_shapes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ All featurizers have compatible shapes!&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✗ Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_shapes</span><span class="p">)</span><span class="si">}</span><span class="s2"> different shapes: </span><span class="si">{</span><span class="n">unique_shapes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Consider using only featurizers with matching shapes for direct stacking.&quot;</span><span class="p">)</span>

<span class="c1"># Group by compatible shapes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="n">shape_groups</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">shape</span> <span class="ow">in</span> <span class="n">shapes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">shape_groups</span><span class="p">[</span><span class="n">shape</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Compatible groups:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">shape</span><span class="p">,</span> <span class="n">names</span> <span class="ow">in</span> <span class="n">shape_groups</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Shape </span><span class="si">{</span><span class="n">shape</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="overview-of-featurizer-categories">
<h3>Overview of Featurizer Categories<a class="headerlink" href="#overview-of-featurizer-categories" title="Link to this heading">¶</a></h3>
<p>PolyglotMol groups featurizers into logical categories:</p>
<ul class="simple">
<li><p><strong>Small Molecule Categories (Examples):</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fingerprints</span></code>: Various 2D fingerprints (Morgan, RDKit topological, Atom Pairs, etc.).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fingerprints/cdk</span></code>: CDK-based fingerprints (often require Java).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fingerprints/datamol</span></code>: Fingerprints leveraging the Datamol library.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">descriptors</span></code>: Collections of 0D/1D/2D/3D molecular descriptors (e.g., from RDKit, Mordred).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">graph</span></code>: Representations of molecules as graphs (e.g., for Graph Neural Networks).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">spatial</span></code> (or <code class="docutils literal notranslate"><span class="pre">matrix</span></code>, <code class="docutils literal notranslate"><span class="pre">spatial_learned</span></code>): Matrix-based (Adjacency, Coulomb) or learned 3D representations (UniMol).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deepchem</span></code>: Featurizers compatible with or wrapping DeepChem functionalities.</p></li>
</ul>
</li>
<li><p><strong>Protein Categories (Examples):</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">protein_language_models</span></code>: Embeddings from Protein Language Models (ESM-2, ProtT5, CARP, Ankh, PepBERT).</p></li>
<li><p><em>(Future categories might include structural protein features, etc.)</em></p></li>
</ul>
</li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="using-featurizers">
<h2>2. Using Featurizers<a class="headerlink" href="#using-featurizers" title="Link to this heading">¶</a></h2>
<section id="getting-a-specific-featurizer-instance">
<h3>Getting a Specific Featurizer Instance<a class="headerlink" href="#getting-a-specific-featurizer-instance" title="Link to this heading">¶</a></h3>
<p>Once you know the registered name of the featurizer:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># For a small molecule featurizer (e.g., MACCS keys)</span>
<span class="n">maccs_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;maccs_keys&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instantiated: </span><span class="si">{</span><span class="n">maccs_featurizer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output: MACCSKeysFP(name=&#39;maccs_keys&#39;)</span>

<span class="c1"># For a protein featurizer (e.g., a small ESM2 model)</span>
<span class="c1"># Replace &#39;esm2_t6_8M_UR50D&#39; with an actual registered key from list_available_protein_featurizers()</span>
<span class="n">protein_plm_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_protein_featurizer</span><span class="p">(</span><span class="s1">&#39;esm2_t6_8M_UR50D&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instantiated: </span><span class="si">{</span><span class="n">protein_plm_featurizer</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output: ESM2Featurizer(name=&#39;esm2_t6_8M_UR50D&#39;, model_name=&#39;esm2_t6_8M_UR50D&#39;, ...)</span>
</pre></div>
</div>
<p>You can often override default parameters by passing them as keyword arguments to <code class="docutils literal notranslate"><span class="pre">get_featurizer</span></code> or <code class="docutils literal notranslate"><span class="pre">get_protein_featurizer</span></code>. For example:
<code class="docutils literal notranslate"><span class="pre">morgan_featurizer_custom</span> <span class="pre">=</span> <span class="pre">pm.get_featurizer('morgan_fp_r2_1024',</span> <span class="pre">nBits=512,</span> <span class="pre">radius=3)</span></code></p>
</section>
<section id="preparing-input-data">
<h3>Preparing Input Data<a class="headerlink" href="#preparing-input-data" title="Link to this heading">¶</a></h3>
<p>PolyglotMol featurizers are designed to accept common input formats directly.</p>
<ul class="simple">
<li><p><strong>Small Molecules</strong>: Input can typically be SMILES strings or pre-processed RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> objects. Utilities like <a class="reference internal" href="../../api/data/index.html#polyglotmol.data.io.mol_from_input" title="polyglotmol.data.io.mol_from_input"><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.data.io.mol_from_input()</span></code></a> are used internally to standardize inputs (e.g., parse SMILES, sanitize RDKit Mols).</p></li>
<li><p><strong>Proteins</strong>: Input is typically a protein sequence string. Future utilities like <code class="docutils literal notranslate"><span class="pre">polyglotmol.data.protein.protein_from_input</span></code> will handle various sources like FASTA files, PDB IDs, etc., to yield a standardized sequence.</p></li>
</ul>
<p>For most use cases, you can pass your raw data (like a SMILES string or protein sequence) directly to the <code class="docutils literal notranslate"><span class="pre">featurize</span></code> method.</p>
</section>
<section id="generating-representations">
<h3>Generating Representations<a class="headerlink" href="#generating-representations" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">featurize()</span></code> method (or calling the featurizer instance directly) computes the features.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Using a pre-instantiated featurizer (e.g., from the previous step)</span>
<span class="c1"># For this example, let&#39;s get a MACCS keys featurizer</span>
<span class="n">maccs_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;maccs_keys&#39;</span><span class="p">)</span>

<span class="c1"># Featurize a single small molecule (SMILES string)</span>
<span class="n">smiles_ethanol</span> <span class="o">=</span> <span class="s2">&quot;CCO&quot;</span>
<span class="n">features_single</span> <span class="o">=</span> <span class="n">maccs_featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">smiles_ethanol</span><span class="p">)</span> <span class="c1"># Or maccs_featurizer(smiles_ethanol)</span>
<span class="k">if</span> <span class="n">features_single</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MACCS features for &#39;</span><span class="si">{</span><span class="n">smiles_ethanol</span><span class="si">}</span><span class="s2">&#39; (shape: </span><span class="si">{</span><span class="n">features_single</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="c1"># Expected Output: MACCS features for &#39;CCO&#39; (shape: (167,))</span>

<span class="c1"># Featurize a list of small molecules</span>
<span class="n">smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">,</span> <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">]</span> <span class="c1"># Ethanol, Propane, Benzene</span>
<span class="n">features_batch</span> <span class="o">=</span> <span class="n">maccs_featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">smiles_list</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">features_batch</span><span class="p">)</span><span class="si">}</span><span class="s2"> molecules for MACCS keys:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fp_vector</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">features_batch</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">fp_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Molecule &#39;</span><span class="si">{</span><span class="n">smiles_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: fingerprint shape </span><span class="si">{</span><span class="n">fp_vector</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Molecule &#39;</span><span class="si">{</span><span class="n">smiles_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: featurization failed.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="handling-different-input-types">
<h2>3. Handling Different Input Types<a class="headerlink" href="#handling-different-input-types" title="Link to this heading">¶</a></h2>
<p>PolyglotMol aims for flexibility in input.</p>
<section id="small-molecule-inputs">
<h3>Small Molecule Inputs<a class="headerlink" href="#small-molecule-inputs" title="Link to this heading">¶</a></h3>
<p>Most small molecule featurizers accept:</p>
<ul class="simple">
<li><p>SMILES strings: <code class="docutils literal notranslate"><span class="pre">&quot;CCO&quot;</span></code></p></li>
<li><p>RDKit <code class="docutils literal notranslate"><span class="pre">Mol</span></code> objects: <code class="docutils literal notranslate"><span class="pre">Chem.MolFromSmiles(&quot;CCO&quot;)</span></code></p></li>
<li><p>Some may also accept InChI strings if supported by internal conversion.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">Chem</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Assume &#39;featurizer&#39; is a small molecule featurizer instance, e.g.,</span>
<span class="c1"># featurizer = pm.get_featurizer(&#39;rdkit_fp_2048&#39;) </span>
<span class="c1"># For demonstration, we re-initialize it here if the previous block wasn&#39;t run</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;rdkit_fp_2048&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping &#39;Handling Different Input Types&#39; example as &#39;rdkit_fp_2048&#39; is not available.&quot;</span><span class="p">)</span>
    <span class="n">featurizer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">featurizer</span><span class="p">:</span>
    <span class="c1"># From SMILES string</span>
    <span class="n">features_smiles</span> <span class="o">=</span> <span class="n">featurizer</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features from SMILES: </span><span class="si">{</span><span class="n">features_smiles</span><span class="o">.</span><span class="n">shape</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">features_smiles</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># From RDKit molecule object</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="s2">&quot;CCC&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mol</span><span class="p">:</span>
        <span class="n">features_mol</span> <span class="o">=</span> <span class="n">featurizer</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features from RDKit Mol: </span><span class="si">{</span><span class="n">features_mol</span><span class="o">.</span><span class="n">shape</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">features_mol</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="kc">None</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;Failed&#39;</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Batch with mixed types (if underlying _prepare_input handles them consistently)</span>
    <span class="c1"># For simplicity, it&#39;s often best to provide a batch of consistent types (all SMILES or all Mols)</span>
    <span class="c1"># molecules_mixed_batch = [&quot;CC(=O)O&quot;, Chem.MolFromSmiles(&quot;c1cnccc1&quot;)]</span>
    <span class="c1"># features_mixed_list = featurizer(molecules_mixed_batch)</span>
    <span class="c1"># print(f&quot;Processed {len(features_mixed_list)} from mixed batch.&quot;)</span>
</pre></div>
</div>
</section>
<section id="protein-sequence-inputs">
<h3>Protein Sequence Inputs<a class="headerlink" href="#protein-sequence-inputs" title="Link to this heading">¶</a></h3>
<p>Protein featurizers (like PLMs) typically expect raw amino acid sequences:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Assume &#39;protein_featurizer&#39; is an instance, e.g.,</span>
<span class="c1"># protein_featurizer = pm.get_protein_featurizer(&#39;esm2_t6_8M_UR50D&#39;)</span>
<span class="c1"># For demonstration, we re-initialize it here</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">protein_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_protein_featurizer</span><span class="p">(</span><span class="s1">&#39;esm2_t6_8M_UR50D&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">DependencyNotFoundError</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping protein input example as &#39;esm2_t6_8M_UR50D&#39; is not available.&quot;</span><span class="p">)</span>
    <span class="n">protein_featurizer</span> <span class="o">=</span> <span class="kc">None</span>


<span class="k">if</span> <span class="n">protein_featurizer</span><span class="p">:</span>
    <span class="c1"># Single sequence</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="s2">&quot;MKTAYIAKQRQISFVKSHFSRQ&quot;</span>
    <span class="n">embedding</span> <span class="o">=</span> <span class="n">protein_featurizer</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">embedding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Protein embedding shape: </span><span class="si">{</span><span class="n">embedding</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Example Output: Protein embedding shape: (320,) for esm2_t6_8M</span>

    <span class="c1"># Multiple sequences</span>
    <span class="n">sequences_batch</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MKTAYIAKQRQISFVKSHFSRQ&quot;</span><span class="p">,</span> <span class="s2">&quot;VITAL&quot;</span><span class="p">,</span> <span class="s2">&quot;LIVMATGSMQALPFDVQEWQLSGPRA&quot;</span><span class="p">]</span>
    <span class="n">embeddings_batch</span> <span class="o">=</span> <span class="n">protein_featurizer</span><span class="p">(</span><span class="n">sequences_batch</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">embeddings_batch</span><span class="p">)</span><span class="si">}</span><span class="s2"> protein sequences.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-mol-from-input-and-protein-from-input-explicitly">
<h3>Using <code class="docutils literal notranslate"><span class="pre">mol_from_input</span></code> and <code class="docutils literal notranslate"><span class="pre">protein_from_input</span></code> Explicitly<a class="headerlink" href="#using-mol-from-input-and-protein-from-input-explicitly" title="Link to this heading">¶</a></h3>
<p>For more complex scenarios or pre-processing, you might use PolyglotMol’s data input functions directly before featurization.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">polyglotmol.data.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">mol_from_input</span> <span class="c1"># Assuming direct import path</span>
<span class="c1"># from polyglotmol.data.protein import protein_from_input # Conceptual</span>

<span class="c1"># Small molecule from SMILES</span>
<span class="n">ethanol_mol_obj</span> <span class="o">=</span> <span class="n">mol_from_input</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="n">input_type</span><span class="o">=</span><span class="s2">&quot;smiles&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">ethanol_mol_obj</span><span class="p">:</span>
    <span class="n">morgan_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">morgan_featurizer</span><span class="p">:</span>
        <span class="n">ethanol_fp</span> <span class="o">=</span> <span class="n">morgan_featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">ethanol_mol_obj</span><span class="p">)</span>
        <span class="c1"># print(f&quot;Ethanol fingerprint shape: {ethanol_fp.shape if ethanol_fp is not None else &#39;Failed&#39;}&quot;)</span>

<span class="c1"># Protein sequence (already a string, protein_from_input would standardize further)</span>
<span class="c1"># protein_seq = &quot;MKTAYI&quot;</span>
<span class="c1"># standardized_protein_seq = protein_from_input(protein_seq) # Example</span>
<span class="c1"># esm_featurizer = pm.get_protein_featurizer(&#39;esm2_t6_8M_UR50D&#39;) # Use an actual key</span>
<span class="c1"># if esm_featurizer and standardized_protein_seq:</span>
<span class="c1">#     protein_embedding = esm_featurizer.featurize(standardized_protein_seq)</span>
<span class="c1">#     # print(f&quot;Protein ESM embedding shape: {protein_embedding.shape if protein_embedding is not None else &#39;Failed&#39;}&quot;)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="parallel-processing-and-batching">
<h2>4. Parallel Processing and Batching<a class="headerlink" href="#parallel-processing-and-batching" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">featurize()</span></code> method can process single items or a list of items. For multiple items, you can leverage parallel processing by setting the <code class="docutils literal notranslate"><span class="pre">n_workers</span></code> argument.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Example: Featurizing a larger list of SMILES using multiple workers</span>
<span class="c1"># featurizer = pm.get_featurizer(&#39;morgan_fp_r2_1024&#39;) # Ensure featurizer is defined</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping parallel processing example as &#39;morgan_fp_r2_1024&#39; is not available.&quot;</span><span class="p">)</span>
    <span class="n">featurizer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">featurizer</span><span class="p">:</span>
    <span class="n">large_smiles_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">,</span> <span class="s2">&quot;c1ccccc1&quot;</span><span class="p">,</span> <span class="s2">&quot;CC(=O)O&quot;</span><span class="p">,</span> <span class="s2">&quot;CNC&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">200</span>  <span class="c1"># Example: 1000 molecules</span>
    
    <span class="c1"># Process with 4 worker processes</span>
    <span class="c1"># The progress_bar=True option will show a TQDM progress bar if tqdm is installed.</span>
    <span class="n">features_parallel</span> <span class="o">=</span> <span class="n">featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">large_smiles_list</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">progress_bar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processed </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">features_parallel</span><span class="p">)</span><span class="si">}</span><span class="s2"> molecules in parallel.&quot;</span><span class="p">)</span>
    <span class="c1"># `features_parallel` is a list of NumPy arrays or Nones</span>

<span class="c1"># Parallel processing for protein sequences (PLMs are often better with n_workers=1 or GPU)</span>
<span class="c1"># protein_featurizer = pm.get_protein_featurizer(&#39;esm2_t6_8M_UR50D&#39;) # Ensure featurizer is defined</span>
<span class="c1"># large_sequences_list = [&quot;MKTAYIAKQRQISFVKSHFSRQ&quot;] * 100</span>
<span class="c1"># embeddings_parallel = protein_featurizer.featurize(large_sequences_list, n_workers=1) # Or adjust based on model</span>
<span class="c1"># print(f&quot;Processed {len(embeddings_parallel)} protein sequences.&quot;)</span>
</pre></div>
</div>
<section id="batch-processing-pipeline-example">
<h3>Batch Processing Pipeline Example<a class="headerlink" href="#batch-processing-pipeline-example" title="Link to this heading">¶</a></h3>
<p>For very large datasets that may not fit into memory all at once, or to manage resources, you can process data in smaller batches.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="k">def</span><span class="w"> </span><span class="nf">process_dataset_in_batches</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">featurizer_name</span><span class="o">=</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">,</span> 
                               <span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Processes a list of inputs (e.g., SMILES) in batches.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initializing featurizer: </span><span class="si">{</span><span class="n">featurizer_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Get the featurizer instance</span>
    <span class="n">featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="n">featurizer_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">featurizer</span><span class="p">:</span> <span class="c1"># Should not happen if name is valid and deps are met</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not get featurizer </span><span class="si">{</span><span class="n">featurizer_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>

    <span class="n">all_features_collected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">valid_item_indices</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> items in batches of </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2"> using </span><span class="si">{</span><span class="n">n_workers</span><span class="si">}</span><span class="s2"> worker(s).&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="n">current_batch</span> <span class="o">=</span> <span class="n">data_list</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Processing batch </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">batch_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">current_batch</span><span class="p">)</span><span class="si">}</span><span class="s2"> items)...&quot;</span><span class="p">)</span>
        <span class="c1"># Featurize the current batch</span>
        <span class="n">batch_feature_results</span> <span class="o">=</span> <span class="n">featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">current_batch</span><span class="p">,</span> <span class="n">n_workers</span><span class="o">=</span><span class="n">n_workers</span><span class="p">)</span>
        
        <span class="c1"># Collect valid features and their original indices</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">feat_vector</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batch_feature_results</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">feat_vector</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">all_features_collected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feat_vector</span><span class="p">)</span>
                <span class="n">valid_item_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">)</span> <span class="c1"># Store the original index of the valid item</span>
    
    <span class="k">if</span> <span class="ow">not</span> <span class="n">all_features_collected</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No valid features were generated.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="p">[]</span>

    <span class="c1"># Stack all collected features into a single NumPy matrix</span>
    <span class="c1"># This assumes all valid feature vectors have the same length.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">feature_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">all_features_collected</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error stacking features: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">. This might happen if feature vectors have inconsistent lengths.&quot;</span><span class="p">)</span>
        <span class="c1"># Fallback: return list of arrays if stacking fails</span>
        <span class="k">return</span> <span class="n">all_features_collected</span><span class="p">,</span> <span class="n">valid_item_indices</span> 
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Finished processing </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span><span class="si">}</span><span class="s2"> items.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Successfully featurized: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_item_indices</span><span class="p">)</span><span class="si">}</span><span class="s2"> items.&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final feature matrix shape: </span><span class="si">{</span><span class="n">feature_matrix</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">feature_matrix</span><span class="p">,</span> <span class="n">valid_item_indices</span>

<span class="c1"># Example usage:</span>
<span class="c1"># smiles_dataset = [&quot;CCO&quot;, &quot;CCC&quot;, &quot;c1ccccc1&quot;, &quot;INVALID_SMILES&quot;, &quot;CC(=O)O&quot;] * 500 # 2500 items</span>
<span class="c1"># feature_matrix_result, valid_idx = process_dataset_in_batches(smiles_dataset, batch_size=100)</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="customizing-featurizers">
<h2>5. Customizing Featurizers<a class="headerlink" href="#customizing-featurizers" title="Link to this heading">¶</a></h2>
<p>You can customize featurizers by:</p>
<ol class="arabic simple">
<li><p>Passing parameters to <code class="docutils literal notranslate"><span class="pre">get_featurizer()</span></code> or <code class="docutils literal notranslate"><span class="pre">get_protein_featurizer()</span></code>.</p></li>
<li><p>Directly instantiating the featurizer class with desired parameters.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Option 1: Pass parameters via get_featurizer</span>
<span class="c1"># Override default radius and nBits for a Morgan fingerprint</span>
<span class="n">custom_morgan1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span>
    <span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">,</span> 
    <span class="n">radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> 
    <span class="n">nBits</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> 
    <span class="n">useChirality</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="c1"># print(custom_morgan1) </span>
<span class="c1"># Expected: MorganBitFP(name=&#39;morgan_fp_r2_1024&#39;, radius=3, nBits=512, useChirality=True, ...)</span>

<span class="c1"># Option 2: Direct instantiation from the class</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">polyglotmol.representations.fingerprints.rdkit</span><span class="w"> </span><span class="kn">import</span> <span class="n">MorganBitFP</span> <span class="c1"># Example path</span>

<span class="n">custom_morgan2</span> <span class="o">=</span> <span class="n">MorganBitFP</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">nBits</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">useChirality</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># print(custom_morgan2)</span>
<span class="c1"># Expected: MorganBitFP(class=MorganBitFP, radius=4, nBits=4096, useChirality=True, ...)</span>
</pre></div>
</div>
</section>
<hr class="docutils" />
<section id="error-handling">
<h2>6. Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h2>
<p>PolyglotMol’s featurization system is designed to handle common issues gracefully.</p>
<section id="missing-dependencies">
<h3>Missing Dependencies<a class="headerlink" href="#missing-dependencies" title="Link to this heading">¶</a></h3>
<p>Featurizers are registered in PolyglotMol even if their underlying dependencies (like RDKit, Mordred, specific PLM libraries) are not installed. An error (typically <code class="docutils literal notranslate"><span class="pre">DependencyNotFoundError</span></code>) will only be raised when you try to <em>instantiate or use</em> such a featurizer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Listing always works, showing all featurizers PolyglotMol *knows about*</span>
<span class="n">all_sm_featurizers</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">list_available_featurizers</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total registered small molecule featurizers: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_sm_featurizers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Attempting to get a featurizer whose dependencies are missing will fail</span>
<span class="c1"># For example, if RDKit is not installed:</span>
<span class="c1"># try:</span>
<span class="c1">#     morgan_featurizer = pm.get_featurizer(&#39;morgan_fp_r2_1024&#39;)</span>
<span class="c1"># except pm.DependencyNotFoundError as e:</span>
<span class="c1">#     print(f&quot;Dependency error: {e}&quot;)</span>
<span class="c1"># Example Output if RDKit missing:</span>
<span class="c1"># Dependency error: RDKit is required for RDKit MorganBitFP. Install RDKit (e.g., pip install rdkit-pypi).</span>
</pre></div>
</div>
</section>
<section id="invalid-inputs">
<h3>Invalid Inputs<a class="headerlink" href="#invalid-inputs" title="Link to this heading">¶</a></h3>
<p>When featurizing a batch of inputs, if some inputs are invalid (e.g., unparsable SMILES strings, sequences with invalid characters for a PLM), the <code class="docutils literal notranslate"><span class="pre">featurize()</span></code> method (with default <code class="docutils literal notranslate"><span class="pre">strict=False</span></code>) will return <code class="docutils literal notranslate"><span class="pre">None</span></code> for those specific items, allowing the rest of the batch to be processed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Assume &#39;morgan_featurizer&#39; is already defined (e.g., from pm.get_featurizer(&#39;morgan_fp_r2_1024&#39;))</span>
<span class="c1"># For this example, let&#39;s quickly get one if the previous block wasn&#39;t run:</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">morgan_featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Skipping invalid input example as &#39;morgan_fp_r2_1024&#39; is not available.&quot;</span><span class="p">)</span>
    <span class="n">morgan_featurizer</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">if</span> <span class="n">morgan_featurizer</span><span class="p">:</span>
    <span class="n">smiles_with_invalid</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;CCO&quot;</span><span class="p">,</span> <span class="s2">&quot;INVALID_SMILES_STRING&quot;</span><span class="p">,</span> <span class="s2">&quot;CCC&quot;</span><span class="p">,</span> <span class="s2">&quot;CC(C)(C)C(=O)O&quot;</span><span class="p">]</span>
    <span class="n">feature_results</span> <span class="o">=</span> <span class="n">morgan_featurizer</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="n">smiles_with_invalid</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nResults for batch with invalid SMILES:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">smi</span><span class="p">,</span> <span class="n">feat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">smiles_with_invalid</span><span class="p">,</span> <span class="n">feature_results</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">feat</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Failed to featurize: &#39;</span><span class="si">{</span><span class="n">smi</span><span class="si">}</span><span class="s2">&#39; (result is None)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Featurized &#39;</span><span class="si">{</span><span class="n">smi</span><span class="si">}</span><span class="s2">&#39;: shape </span><span class="si">{</span><span class="n">feat</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Results for batch with invalid SMILES:</span>
<span class="c1">#   Featurized &#39;CCO&#39;: shape (1024,)</span>
<span class="c1">#   Failed to featurize: &#39;INVALID_SMILES_STRING&#39; (result is None)</span>
<span class="c1">#   Featurized &#39;CCC&#39;: shape (1024,)</span>
<span class="c1">#   Featurized &#39;CC(C)(C)C(=O)O&#39;: shape (1024,)</span>
</pre></div>
</div>
<p>If you set <code class="docutils literal notranslate"><span class="pre">strict=True</span></code> when calling <code class="docutils literal notranslate"><span class="pre">featurize(...,</span> <span class="pre">strict=True)</span></code> for parallel processing (<code class="docutils literal notranslate"><span class="pre">n_workers</span> <span class="pre">&gt;</span> <span class="pre">1</span></code>), an <em>unhandled</em> exception in a worker process would cause the main <code class="docutils literal notranslate"><span class="pre">featurize</span></code> call to raise a <a class="reference internal" href="../../api/representations/utils.html#polyglotmol.representations.utils.FeaturizationError" title="polyglotmol.representations.utils.exceptions.FeaturizationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">FeaturizationError</span></code></a> (wrapping a <code class="docutils literal notranslate"><span class="pre">WorkerError</span></code>). However, <code class="docutils literal notranslate"><span class="pre">InvalidInputError</span></code> from SMILES parsing is typically handled within the worker by returning <code class="docutils literal notranslate"><span class="pre">None</span></code>, so <code class="docutils literal notranslate"><span class="pre">strict=True</span></code> will not cause <code class="docutils literal notranslate"><span class="pre">featurize()</span></code> to raise an error for this specific handled case.</p>
</section>
</section>
<hr class="docutils" />
<section id="further-examples">
<h2>7. Further Examples<a class="headerlink" href="#further-examples" title="Link to this heading">¶</a></h2>
<section id="fingerprint-comparison">
<h3>Fingerprint Comparison<a class="headerlink" href="#fingerprint-comparison" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Compare different types of fingerprints for the same molecule</span>
<span class="c1"># Ensure these featurizer keys are registered in your PolyglotMol setup</span>
<span class="n">fingerprint_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;morgan_fp_r2_1024&#39;</span><span class="p">,</span> <span class="s1">&#39;rdkit_fp_2048&#39;</span><span class="p">,</span> <span class="s1">&#39;maccs_keys&#39;</span><span class="p">]</span>
<span class="n">example_smiles</span> <span class="o">=</span> <span class="s2">&quot;Cc1ccccc1O&quot;</span> <span class="c1"># o-Cresol</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nComparing fingerprints for: </span><span class="si">{</span><span class="n">example_smiles</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">fp_key</span> <span class="ow">in</span> <span class="n">fingerprint_keys</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">featurizer</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="n">fp_key</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">featurizer</span><span class="p">(</span><span class="n">example_smiles</span><span class="p">)</span> <span class="c1"># Using __call__ shortcut for featurize</span>
        <span class="k">if</span> <span class="n">features</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">fp_key</span><span class="si">}</span><span class="s2">: shape </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, sum of bits </span><span class="si">{</span><span class="n">features</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">fp_key</span><span class="si">}</span><span class="s2">: Failed to featurize.&quot;</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">fp_key</span><span class="si">}</span><span class="s2">: Featurizer not available.&quot;</span><span class="p">)</span>
<span class="c1"># Example Output:</span>
<span class="c1"># Comparing fingerprints for: Cc1ccccc1O</span>
<span class="c1">#   morgan_fp_r2_1024: shape (1024,), sum of bits 17.0</span>
<span class="c1">#   rdkit_fp_2048: shape (2048,), sum of bits 124.0</span>
<span class="c1">#   maccs_keys: shape (167,), sum of bits 21.0</span>
</pre></div>
</div>
</section>
<section id="descriptor-calculation">
<h3>Descriptor Calculation<a class="headerlink" href="#descriptor-calculation" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">polyglotmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>

<span class="c1"># Calculate RDKit descriptors</span>
<span class="c1"># Ensure &#39;rdkit_all_descriptors&#39; is registered</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">rdkit_desc_calculator</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;rdkit_all_descriptors&#39;</span><span class="p">)</span>
    <span class="n">ethanol_descriptors</span> <span class="o">=</span> <span class="n">rdkit_desc_calculator</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ethanol_descriptors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nNumber of RDKit descriptors for Ethanol: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ethanol_descriptors</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Example Output: Number of RDKit descriptors for Ethanol: 210 (varies with RDKit version)</span>
<span class="k">except</span> <span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&#39;rdkit_all_descriptors&#39; not available.&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Mordred descriptors (2D only)</span>
<span class="c1"># Ensure &#39;mordred_descriptors_2d&#39; is registered and Mordred is installed</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">mordred_desc_calculator</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">get_featurizer</span><span class="p">(</span><span class="s1">&#39;mordred_descriptors_2d&#39;</span><span class="p">)</span>
    <span class="n">ethanol_mordred_desc</span> <span class="o">=</span> <span class="n">mordred_desc_calculator</span><span class="o">.</span><span class="n">featurize</span><span class="p">(</span><span class="s2">&quot;CCO&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ethanol_mordred_desc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Mordred 2D descriptors for Ethanol: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ethanol_mordred_desc</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Example Output: Number of Mordred 2D descriptors for Ethanol: 1613 (varies with Mordred version)</span>
<span class="k">except</span> <span class="p">(</span><span class="n">pm</span><span class="o">.</span><span class="n">RegistryError</span><span class="p">,</span> <span class="n">pm</span><span class="o">.</span><span class="n">DependencyNotFoundError</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&#39;mordred_descriptors_2d&#39; not available or Mordred library missing.&quot;</span><span class="p">)</span>

</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="best-practices">
<h2>8. Best Practices<a class="headerlink" href="#best-practices" title="Link to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p><strong>Discover First</strong>: Use <code class="docutils literal notranslate"><span class="pre">pm.list_available_featurizers()</span></code> or <code class="docutils literal notranslate"><span class="pre">pm.print_available_featurizers()</span></code> to see what’s available and their registered names.</p></li>
<li><p><strong>Check Return Values</strong>: When featurizing batches, always check for <code class="docutils literal notranslate"><span class="pre">None</span></code> in the returned list, as individual items might fail.</p></li>
<li><p><strong>Choose Appropriately</strong>: Select featurizers based on your task:</p>
<ul class="simple">
<li><p><strong>Fingerprints</strong> (e.g., Morgan, MACCS) are good for similarity searches, basic screening models.</p></li>
<li><p><strong>Descriptors</strong> (e.g., RDKit, Mordred) are often used for QSAR modeling.</p></li>
<li><p><strong>Graph Representations</strong> are for Graph Neural Networks (GNNs).</p></li>
<li><p><strong>Spatial/3D Representations</strong> (e.g., Coulomb Matrix, UniMol) are for models that can leverage 3D information.</p></li>
<li><p><strong>Protein Language Model Embeddings</strong> (e.g., ESM, ProtT5) for sequence-based protein tasks.</p></li>
</ul>
</li>
<li><p><strong>Parallel Processing</strong>: For datasets with thousands of items, use the <code class="docutils literal notranslate"><span class="pre">n_workers</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">featurize()</span></code> method to speed up computation. Note that some featurizers (like GPU-based PLMs) may perform best with <code class="docutils literal notranslate"><span class="pre">n_workers=1</span></code>.</p></li>
<li><p><strong>Caching Results</strong>: For computationally expensive featurizations (e.g., some 3D descriptors, PLM embeddings for very long sequences), consider caching the generated features locally to avoid re-computation.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="api-reference">
<h2>9. API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h2>
<section id="core-functions-for-featurizer-access">
<h3>Core Functions for Featurizer Access:<a class="headerlink" href="#core-functions-for-featurizer-access" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.list_available_featurizers()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.get_featurizer()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.get_featurizer_info()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.list_available_protein_featurizers()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.get_protein_featurizer()</span></code></p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">polyglotmol.representations.get_protein_featurizer_info()</span></code></p></li>
<li><p><em>(Utility for printing, if exposed at top level)</em> <code class="docutils literal notranslate"><span class="pre">{py:func}</span></code>polyglotmol.print_available_featurizers`</p></li>
</ul>
</section>
<section id="base-classes">
<h3>Base Classes:<a class="headerlink" href="#base-classes" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference internal" href="../../api/representations/utils.html#polyglotmol.representations.utils.BaseFeaturizer" title="polyglotmol.representations.utils.base.BaseFeaturizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">polyglotmol.representations.utils.base.BaseFeaturizer</span></code></a></p></li>
<li><p><em>(If defined and relevant)</em> <code class="docutils literal notranslate"><span class="pre">{py:class}</span></code>polyglotmol.representations.protein.base.BaseProteinFeaturizer`</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="related-links">
<h2>10. Related Links<a class="headerlink" href="#related-links" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="../representations/fingerprints/index.html"><span class="doc">Fingerprints</span></a> (Overview of fingerprint types)</p></li>
<li><p><a class="reference internal" href="../representations/descriptors/index.html"><span class="doc">Molecular Descriptors</span></a> (Overview of descriptor types)</p></li>
<li><p><a class="reference internal" href="../representations/spatial/index.html"><span class="doc">Spatial Representations</span></a> (Overview of spatial/3D types)</p></li>
<li><p><a class="reference internal" href="../representations/protein/index.html"><span class="doc">Protein Representations</span></a> (Overview of protein representation types)</p></li>
<li><p><a class="reference internal" href="../../api/representations/index.html"><span class="doc">Representations Module</span></a> (Root of the representations API documentation)</p></li>
</ul>
<div class="toctree-wrapper compound">
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="config.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Configuration</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Basics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Xufan Gao
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Featurizers</a><ul>
<li><a class="reference internal" href="#core-workflow">Core Workflow</a></li>
<li><a class="reference internal" href="#discovering-available-featurizers">1. Discovering Available Featurizers</a><ul>
<li><a class="reference internal" href="#listing-featurizer-names">Listing Featurizer Names</a></li>
<li><a class="reference internal" href="#categorized-and-pretty-printed-view">Categorized and Pretty-Printed View</a></li>
<li><a class="reference internal" href="#getting-detailed-information-with-shape">Getting Detailed Information with Shape</a></li>
<li><a class="reference internal" href="#checking-shapes-of-all-cdk-fingerprints">Checking Shapes of All CDK Fingerprints</a></li>
<li><a class="reference internal" href="#finding-featurizers-by-shape">Finding Featurizers by Shape</a></li>
<li><a class="reference internal" href="#shape-compatibility-check">Shape Compatibility Check</a></li>
<li><a class="reference internal" href="#overview-of-featurizer-categories">Overview of Featurizer Categories</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-featurizers">2. Using Featurizers</a><ul>
<li><a class="reference internal" href="#getting-a-specific-featurizer-instance">Getting a Specific Featurizer Instance</a></li>
<li><a class="reference internal" href="#preparing-input-data">Preparing Input Data</a></li>
<li><a class="reference internal" href="#generating-representations">Generating Representations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handling-different-input-types">3. Handling Different Input Types</a><ul>
<li><a class="reference internal" href="#small-molecule-inputs">Small Molecule Inputs</a></li>
<li><a class="reference internal" href="#protein-sequence-inputs">Protein Sequence Inputs</a></li>
<li><a class="reference internal" href="#using-mol-from-input-and-protein-from-input-explicitly">Using <code class="docutils literal notranslate"><span class="pre">mol_from_input</span></code> and <code class="docutils literal notranslate"><span class="pre">protein_from_input</span></code> Explicitly</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parallel-processing-and-batching">4. Parallel Processing and Batching</a><ul>
<li><a class="reference internal" href="#batch-processing-pipeline-example">Batch Processing Pipeline Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-featurizers">5. Customizing Featurizers</a></li>
<li><a class="reference internal" href="#error-handling">6. Error Handling</a><ul>
<li><a class="reference internal" href="#missing-dependencies">Missing Dependencies</a></li>
<li><a class="reference internal" href="#invalid-inputs">Invalid Inputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#further-examples">7. Further Examples</a><ul>
<li><a class="reference internal" href="#fingerprint-comparison">Fingerprint Comparison</a></li>
<li><a class="reference internal" href="#descriptor-calculation">Descriptor Calculation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#best-practices">8. Best Practices</a></li>
<li><a class="reference internal" href="#api-reference">9. API Reference</a><ul>
<li><a class="reference internal" href="#core-functions-for-featurizer-access">Core Functions for Featurizer Access:</a></li>
<li><a class="reference internal" href="#base-classes">Base Classes:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#related-links">10. Related Links</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=837179f8"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>